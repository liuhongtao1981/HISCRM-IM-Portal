# HisCrm-IM - ç¤¾äº¤åª’ä½“è´¦æˆ·ç›‘æ§ä¸é€šçŸ¥ç³»ç»Ÿ

> åŸºäºMaster-Workeræ¶æ„çš„å¤šå¹³å°ç¤¾äº¤åª’ä½“ç›‘æ§ç³»ç»Ÿ

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

- âœ… **è´¦æˆ·ç®¡ç†**: æ”¯æŒå¤šä¸ªç¤¾äº¤åª’ä½“è´¦æˆ·(æŠ–éŸ³)çš„é›†ä¸­ç®¡ç†
- âœ… **å®æ—¶ç›‘æ§**: 30ç§’å‘¨æœŸè‡ªåŠ¨ç›‘æ§è¯„è®ºå’Œç§ä¿¡
- âœ… **å¤šç«¯é€šçŸ¥**: æ¡Œé¢å’Œç§»åŠ¨å®¢æˆ·ç«¯å®æ—¶é€šçŸ¥æ¨é€
- âœ… **å†å²è®°å½•**: 30å¤©å†å²æ¶ˆæ¯æŸ¥è¯¢å’Œç»Ÿè®¡åˆ†æ
- âœ… **é€šçŸ¥è§„åˆ™**: æ”¯æŒå…³é”®è¯è¿‡æ»¤ã€å…æ‰“æ‰°æ—¶æ®µç­‰è‡ªå®šä¹‰è§„åˆ™
- âœ… **é«˜å¯ç”¨æ€§**: Workeræ•…éšœè‡ªåŠ¨æ¢å¤,ä»»åŠ¡æ— ç¼è¿ç§»

## ğŸ—ï¸ æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ¡Œé¢å®¢æˆ·ç«¯   â”‚â”€â”€â”€â”€â–¶â”‚    ä¸»æ§æœåŠ¡    â”‚â—€â”€â”€â”€â”€â”‚  WorkerèŠ‚ç‚¹  â”‚
â”‚   (Electron) â”‚     â”‚   (Master)   â”‚     â”‚  (Crawler)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                     â”‚
       â”‚                   â”‚                     â”‚
   WebSocket           SQLite              å¹³å°API/æŠ“å–
```

**æŠ€æœ¯æ ˆ**:
- **Runtime**: Node.js 18.x LTS
- **é€šä¿¡**: Socket.IO 4.x (WebSocket + JSON)
- **æ•°æ®åº“**: SQLite 3.x (better-sqlite3)
- **æ¡Œé¢å®¢æˆ·ç«¯**: Electron 28.x + React 18.x + Ant Design
- **ç§»åŠ¨å®¢æˆ·ç«¯**: React Native 0.73.x + React Native Paper
- **è¿›ç¨‹ç®¡ç†**: PM2 / child_process
- **æµ‹è¯•**: Jest 29.x + Supertest + Playwright

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
packages/
â”œâ”€â”€ master/          # ä¸»æ§æœåŠ¡(ä»»åŠ¡è°ƒåº¦ã€Workerç®¡ç†ã€å®¢æˆ·ç«¯é€šä¿¡)
â”œâ”€â”€ worker/          # Workerè¿›ç¨‹(æŠ–éŸ³ç›‘æ§æ‰§è¡Œå™¨)
â”œâ”€â”€ shared/          # å…±äº«ä»£ç (åè®®å®šä¹‰ã€æ¨¡å‹ã€å·¥å…·å‡½æ•°)
â”œâ”€â”€ desktop-client/  # Electronæ¡Œé¢å®¢æˆ·ç«¯
â”œâ”€â”€ mobile-client/   # React Nativeç§»åŠ¨å®¢æˆ·ç«¯
â””â”€â”€ tests/           # è·¨åŒ…é›†æˆæµ‹è¯•
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®æ¡ä»¶

- Node.js 18.x LTS
- pnpm 8.x+

### å®‰è£…

```bash
# 1. å…‹éš†ä»“åº“
git clone <repository_url>
cd hiscrm-im

# 2. å®‰è£…ä¾èµ–
npm install -g pnpm
pnpm install

# 3. åˆå§‹åŒ–æ•°æ®åº“
cd packages/master
npm run db:init

# 4. é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘.envè®¾ç½®åŠ å¯†å¯†é’¥ç­‰é…ç½®
```

### å¼€å‘æ¨¡å¼

```bash
# å¯åŠ¨ä¸»æ§æœåŠ¡
pnpm dev:master

# å¯åŠ¨Workerè¿›ç¨‹(å¦ä¸€ä¸ªç»ˆç«¯)
pnpm dev:worker

# å¯åŠ¨æ¡Œé¢å®¢æˆ·ç«¯(å¦ä¸€ä¸ªç»ˆç«¯)
pnpm dev:desktop
```

### ç”Ÿäº§éƒ¨ç½²

```bash
# ä½¿ç”¨PM2å¯åŠ¨ä¸»æ§(ä¼šè‡ªåŠ¨ç®¡ç†Worker)
pm2 start packages/master/src/index.js --name hiscrm-master

# æ‰“åŒ…æ¡Œé¢å®¢æˆ·ç«¯
pnpm --filter @hiscrm-im/desktop-client build
```

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pnpm test

# è¿è¡Œå•ä¸ªåŒ…çš„æµ‹è¯•
pnpm --filter @hiscrm-im/master test

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
pnpm test -- --coverage
```

## ğŸ“– æ–‡æ¡£

- [åŠŸèƒ½è§„æ ¼](./specs/001-worker/spec.md)
- [å®æ–½è®¡åˆ’](./specs/001-worker/plan.md)
- [æ•°æ®æ¨¡å‹](./specs/001-worker/data-model.md)
- [APIå¥‘çº¦](./specs/001-worker/contracts/)
- [å¿«é€ŸéªŒè¯æŒ‡å—](./specs/001-worker/quickstart.md)
- [ä»»åŠ¡åˆ—è¡¨](./specs/001-worker/tasks.md)

## ğŸ”’ å®‰å…¨æ€§

- è´¦æˆ·å‡­è¯ä½¿ç”¨AES-256åŠ å¯†å­˜å‚¨
- ç”Ÿäº§ç¯å¢ƒä½¿ç”¨WSSåŠ å¯†é€šä¿¡
- æ”¯æŒJWT Tokenè®¤è¯
- æ§åˆ¶ç›‘æ§é¢‘ç‡é¿å…å¹³å°å°ç¦

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

- ç›‘æ§å»¶è¿Ÿ: â‰¤ 30ç§’
- é€šçŸ¥æ¨é€å»¶è¿Ÿ: â‰¤ 3ç§’
- Workeræ•…éšœæ¢å¤: â‰¤ 30ç§’
- æ”¯æŒå¹¶å‘ç›‘æ§: 10+ è´¦æˆ·

## ğŸ“ è®¸å¯è¯

MIT

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Request!

---

**ç”Ÿæˆæ—¥æœŸ**: 2025-10-11
**ç‰ˆæœ¬**: 1.0.0

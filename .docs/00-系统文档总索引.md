# HisCrm-IM ç³»ç»Ÿå®Œæ•´æ–‡æ¡£æ€»ç´¢å¼•

**åˆ›å»ºæ—¥æœŸ**: 2025-10-18
**ç‰ˆæœ¬**: 1.0.0
**çŠ¶æ€**: âœ… å®Œæˆ

---

## ğŸ“š æ–‡æ¡£æ¦‚è§ˆ

æœ¬æ–‡æ¡£å°† HisCrm-IM ç³»ç»Ÿåˆ†ä¸ºä¸‰ä¸ªæ ¸å¿ƒæ¨¡å—ï¼Œä¸ºæ¯ä¸ªæ¨¡å—æä¾›å®Œæ•´çš„ç³»ç»Ÿæ–‡æ¡£ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           HisCrm-IM ç³»ç»Ÿæ–‡æ¡£æ€»ä½“ç»“æ„                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  Admin Web       â”‚  â”‚  Master Server   â”‚             â”‚
â”‚  â”‚  (ç«¯å£ 3001)      â”‚  â”‚  (ç«¯å£ 3000)      â”‚             â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚             â”‚
â”‚  â”‚ ğŸ“„ 01-ç³»ç»Ÿæ–‡æ¡£   â”‚  â”‚ ğŸ“„ 02-ç³»ç»Ÿæ–‡æ¡£   â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                           â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚            â”‚   Worker (ç«¯å£ 4000+)    â”‚                 â”‚
â”‚            â”‚                          â”‚                 â”‚
â”‚            â”‚ ğŸ“„ 03-ç³»ç»Ÿæ–‡æ¡£-ç¬¬ä¸€éƒ¨åˆ†   â”‚                 â”‚
â”‚            â”‚ ğŸ“„ 04-ç³»ç»Ÿæ–‡æ¡£-ç¬¬äºŒéƒ¨åˆ†   â”‚                 â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ å¿«é€Ÿå¯¼èˆª

### æˆ‘æ˜¯æ–°æ‰‹ï¼Œæƒ³å¿«é€Ÿäº†è§£ç³»ç»Ÿ

**æ¨èé˜…è¯»é¡ºåº**:

1. **ä»æ•´ä½“ç†è§£ç³»ç»Ÿ**
   - é˜…è¯»: `ç³»ç»Ÿæ¶æ„ä¸æ ¸å¿ƒæµç¨‹.md` (ç°æœ‰æ–‡æ¡£)
   - æ—¶é—´: 10 åˆ†é’Ÿ

2. **äº†è§£ä¸‰ä¸ªæ¨¡å—çš„ä½œç”¨**
   - Admin Web: ç†è§£ç®¡ç†åå°çš„åŠŸèƒ½å’Œé¡µé¢
   - Master: ç†è§£ä¸­å¤®åè°ƒçš„æµç¨‹
   - Worker: ç†è§£æµè§ˆå™¨è‡ªåŠ¨åŒ–å’Œçˆ¬è™«

3. **è·Ÿè¸ªä¸€ä¸ªå®Œæ•´çš„æµç¨‹**
   - è´¦æˆ·ç™»å½•æµç¨‹: ä» Admin Web â†’ Master â†’ Worker â†’ Browser
   - æ—¶é—´: 20 åˆ†é’Ÿ

---

### æˆ‘éœ€è¦éƒ¨ç½²ç³»ç»Ÿ

**æ¨èé˜…è¯»é¡ºåº**:

1. **Admin Web éƒ¨ç½²**
   - ğŸ“„ [01-ADMIN-WEB-ç³»ç»Ÿæ–‡æ¡£.md](#admin-web-ç³»ç»Ÿæ–‡æ¡£) â†’ éƒ¨ç½²è¯´æ˜
   - å‘½ä»¤: `npm install && npm start`

2. **Master éƒ¨ç½²**
   - ğŸ“„ [02-MASTER-ç³»ç»Ÿæ–‡æ¡£.md](#master-ç³»ç»Ÿæ–‡æ¡£) â†’ éƒ¨ç½²è¯´æ˜
   - å‘½ä»¤: `npm start` æˆ– `pm2 start ...`

3. **Worker éƒ¨ç½²**
   - ğŸ“„ [03-WORKER-ç³»ç»Ÿæ–‡æ¡£-ç¬¬ä¸€éƒ¨åˆ†.md](#worker-ç³»ç»Ÿæ–‡æ¡£) â†’ æ ¸å¿ƒæ¨¡å—
   - ğŸ“„ [04-WORKER-ç³»ç»Ÿæ–‡æ¡£-ç¬¬äºŒéƒ¨åˆ†.md](#worker-ç³»ç»Ÿæ–‡æ¡£) â†’ éƒ¨ç½²è¿ç»´
   - å‘½ä»¤: `WORKER_ID=worker-1 PORT=4000 npm start`

---

### æˆ‘éœ€è¦ä¿®å¤æŸä¸ªåŠŸèƒ½

**æŒ‰æ¨¡å—æŸ¥æ‰¾**:

| åŠŸèƒ½ | æ¨¡å— | æ–‡æ¡£ä½ç½® |
|------|------|---------|
| ç™»å½•ç•Œé¢ã€è´¦æˆ·ç®¡ç†ã€æ¶ˆæ¯æŸ¥çœ‹ | Admin Web | [01-ADMIN-WEB](#admin-web-ç³»ç»Ÿæ–‡æ¡£) |
| ç™»å½•ä¼šè¯ã€Worker ç®¡ç†ã€æ•°æ®åº“ | Master | [02-MASTER](#master-ç³»ç»Ÿæ–‡æ¡£) |
| æµè§ˆå™¨è‡ªåŠ¨åŒ–ã€çˆ¬è™«ã€å¤šBrowser | Worker | [03/04-WORKER](#worker-ç³»ç»Ÿæ–‡æ¡£) |

---

## ğŸ“„ æ–‡æ¡£è¯¦è§£

### Admin Web ç³»ç»Ÿæ–‡æ¡£

**æ–‡ä»¶**: `01-ADMIN-WEB-ç³»ç»Ÿæ–‡æ¡£.md`

**å†…å®¹æ¦‚è§ˆ**:

| ç« èŠ‚ | è¯´æ˜ | å…³é”®å†…å®¹ |
|------|------|---------|
| ç³»ç»Ÿæ¦‚è¿° | Admin Web èŒè´£å®šä½ | æŠ€æœ¯æ ˆã€è®¿é—®æ–¹å¼ |
| æ¶æ„è®¾è®¡ | æ•´ä½“æ¶æ„å’Œç›®å½•ç»“æ„ | React ç»„ä»¶å±‚çº§ |
| æ ¸å¿ƒåŠŸèƒ½ | äº”å¤§åŠŸèƒ½æ¨¡å— | è´¦æˆ·ç®¡ç†ã€ç™»å½•ç®¡ç†ã€æ¶ˆæ¯ç®¡ç†ç­‰ |
| é¡µé¢è¯´æ˜ | å„é¡µé¢è¯¦ç»†è¯´æ˜ | AccountsPageã€MessageManagementPage ç­‰ |
| Socket.IO é€šä¿¡ | å®æ—¶é€šä¿¡æœºåˆ¶ | äº‹ä»¶ç›‘å¬ã€ä¸Šä¸‹æ–‡å®ç° |
| API è°ƒç”¨ | HTTP API æ¥å£ | è´¦æˆ·ã€Workerã€æ¶ˆæ¯æŸ¥è¯¢ API |
| æ•°æ®æµ | ç™»å½•æµç¨‹æ•°æ®æµ | Admin â†’ Master â†’ Worker â†’ Browser |
| çŠ¶æ€ç®¡ç† | å…¨å±€å’Œå±€éƒ¨çŠ¶æ€ | Socket ä¸Šä¸‹æ–‡ã€è‡ªå®šä¹‰ Hooks |
| éƒ¨ç½²è¯´æ˜ | å¼€å‘å’Œç”Ÿäº§éƒ¨ç½² | npm startã€ç¯å¢ƒå˜é‡ |

**å…³é”®é¡µé¢æ–‡ä»¶**:
- `packages/admin-web/src/pages/AccountsPage.js` - è´¦æˆ·ç®¡ç†
- `packages/admin-web/src/pages/MessageManagementPage.js` - æ¶ˆæ¯ç®¡ç†
- `packages/admin-web/src/pages/LoginManagementPage.js` - ç™»å½•ç®¡ç†
- `packages/admin-web/src/services/socketContext.js` - Socket ä¸Šä¸‹æ–‡

**å…³é”®æµç¨‹**:

```
ç”¨æˆ·ç‚¹å‡»ç™»å½•æŒ‰é’®
    â†“
Admin Web å‘é€ Socket äº‹ä»¶
    â†“
Master åˆ›å»ºä¼šè¯ï¼Œè½¬å‘ç»™ Worker
    â†“
Worker å¯åŠ¨æµè§ˆå™¨ï¼Œæå–äºŒç»´ç 
    â†“
Admin Web æ˜¾ç¤ºäºŒç»´ç å¼¹çª—
    â†“
ç”¨æˆ·æ‰«ç ç™»å½• (åœ¨æ‰‹æœºä¸Š)
    â†“
Worker æ£€æµ‹åˆ°ç™»å½•æˆåŠŸï¼Œä¿å­˜ Cookie
    â†“
Admin Web å…³é—­å¼¹çª—ï¼Œæ˜¾ç¤ºæˆåŠŸæç¤º
```

---

### Master ç³»ç»Ÿæ–‡æ¡£

**æ–‡ä»¶**: `02-MASTER-ç³»ç»Ÿæ–‡æ¡£.md`

**å†…å®¹æ¦‚è§ˆ**:

| ç« èŠ‚ | è¯´æ˜ | å…³é”®å†…å®¹ |
|------|------|---------|
| ç³»ç»Ÿæ¦‚è¿° | Master èŒè´£å®šä½ | ä¸­å¤®åè°ƒå™¨ã€æ ¸å¿ƒæµç¨‹ |
| æ¶æ„è®¾è®¡ | å†…éƒ¨æ¶æ„å’Œç›®å½•ç»“æ„ | Socket æœåŠ¡å™¨ã€ä¸šåŠ¡é€»è¾‘å±‚ |
| æ ¸å¿ƒæ¨¡å— | äº”ä¸ªæ ¸å¿ƒæ¨¡å—è¯¦è§£ | WorkerManagerã€LoginHandlerã€TaskScheduler ç­‰ |
| æ•°æ®åº“è®¾è®¡ | å®Œæ•´æ•°æ®åº“è¡¨ç»“æ„ | accountsã€workersã€login_sessions ç­‰ 8 ä¸ªè¡¨ |
| Socket.IO é€šä¿¡ | ä¸‰ä¸ªå‘½åç©ºé—´ | /workerã€/adminã€/client |
| HTTP API | å®Œæ•´ API ç«¯ç‚¹åˆ—è¡¨ | è´¦æˆ·ã€Workerã€æ¶ˆæ¯ã€é€šçŸ¥ API |
| ä¸šåŠ¡æµç¨‹ | å››ä¸ªæ ¸å¿ƒæµç¨‹ | Worker æ³¨å†Œã€è´¦æˆ·ç™»å½•ã€ä»»åŠ¡è°ƒåº¦ã€ç¦»çº¿å¤„ç† |
| éƒ¨ç½²è¯´æ˜ | å¼€å‘å’Œç”Ÿäº§éƒ¨ç½² | npm startã€PM2ã€ç¯å¢ƒå˜é‡ |

**æ ¸å¿ƒæ•°æ®åº“è¡¨**:

```
accounts              - ç¤¾äº¤åª’ä½“è´¦æˆ·
workers               - Worker èŠ‚ç‚¹
login_sessions        - ç™»å½•ä¼šè¯ (ä¸´æ—¶)
comments              - çˆ¬å–çš„è¯„è®º
direct_messages       - çˆ¬å–çš„ç§ä¿¡
notifications         - é€šçŸ¥é˜Ÿåˆ—
worker_configs        - Worker é…ç½®
worker_runtime        - Worker è¿è¡ŒçŠ¶æ€
```

**ä¸‰ä¸ªå‘½åç©ºé—´é€šä¿¡**:

```
/worker
  â”œâ”€â”€ Worker æ³¨å†Œ
  â”œâ”€â”€ å¿ƒè·³ä¸ŠæŠ¥
  â”œâ”€â”€ äºŒç»´ç å‘é€
  â”œâ”€â”€ ç™»å½•çŠ¶æ€æ›´æ–°
  â””â”€â”€ ç›‘æ§æ•°æ®ä¸ŠæŠ¥

/admin
  â”œâ”€â”€ å¯åŠ¨ç™»å½•è¯·æ±‚
  â”œâ”€â”€ äºŒç»´ç å‡†å¤‡å®Œæ¯•
  â”œâ”€â”€ ç™»å½•æˆåŠŸ/å¤±è´¥é€šçŸ¥
  â””â”€â”€ å®æ—¶æ¶ˆæ¯æ¨é€

/client
  â””â”€â”€ æ¡Œé¢/ç§»åŠ¨å®¢æˆ·ç«¯é€šçŸ¥
```

---

### Worker ç³»ç»Ÿæ–‡æ¡£

**æ–‡ä»¶**:
- `03-WORKER-ç³»ç»Ÿæ–‡æ¡£-ç¬¬ä¸€éƒ¨åˆ†.md`
- `04-WORKER-ç³»ç»Ÿæ–‡æ¡£-ç¬¬äºŒéƒ¨åˆ†.md`

**ç¬¬ä¸€éƒ¨åˆ†å†…å®¹**:

| ç« èŠ‚ | è¯´æ˜ | å…³é”®å†…å®¹ |
|------|------|---------|
| ç³»ç»Ÿæ¦‚è¿° | Worker èŒè´£å®šä½ | æµè§ˆå™¨è‡ªåŠ¨åŒ–ã€çˆ¬è™«ã€éš”ç¦» |
| æ¶æ„è®¾è®¡ | å†…éƒ¨æ¶æ„å’Œç›®å½•ç»“æ„ | Socket å®¢æˆ·ç«¯ã€å¹³å°ç®¡ç† |
| æ ¸å¿ƒæ¨¡å— | äº”ä¸ªæ ¸å¿ƒæ¨¡å— | å…¥å£ã€Socket å®¢æˆ·ç«¯ã€æ³¨å†Œã€å¿ƒè·³ã€äº‹ä»¶ç›‘å¬ |
| å¤šBrowseræ¶æ„ | å…³é”®è®¾è®¡ | æ¯è´¦æˆ·ä¸€ä¸ª Browser è¿›ç¨‹ |
| å¹³å°ç³»ç»Ÿ | åŠ¨æ€åŠ è½½å¹³å° | PlatformManagerã€PlatformBaseã€DouyinPlatform |

**ç¬¬äºŒéƒ¨åˆ†å†…å®¹**:

| ç« èŠ‚ | è¯´æ˜ | å…³é”®å†…å®¹ |
|------|------|---------|
| ä»»åŠ¡ç®¡ç† | MonitorTask æ‰§è¡Œ | éšæœºé—´éš”ã€é€’å½’è°ƒåº¦ |
| Socket.IO é€šä¿¡ | æ¶ˆæ¯åè®®è¯¦è§£ | 14 ä¸ªäº‹ä»¶è¯¦ç»†è¯´æ˜ |
| æ•°æ®å­˜å‚¨ | æ–‡ä»¶ç»“æ„å’Œæ ¼å¼ | æŒ‡çº¹ã€Cookieã€ä¸Šä¸‹æ–‡ã€æˆªå›¾ |
| é”™è¯¯å¤„ç† | é”™è¯¯åˆ†ç±»å’Œé‡è¯• | ç½‘ç»œé”™è¯¯ã€è¶…æ—¶ã€é‡è¯•æœºåˆ¶ |
| éƒ¨ç½²è¿ç»´ | å¯åŠ¨å’Œç›‘æ§ | PM2ã€æ—¥å¿—ã€ç›‘æ§æŒ‡æ ‡ |

**å¤šBrowseræ¶æ„åŸç†**:

```
æ¯ä¸ªè´¦æˆ· = 1 ä¸ªç‹¬ç«‹ Browser è¿›ç¨‹

Browser 1 (Account A)          Browser 2 (Account B)
â”œâ”€â”€ Chromium è¿›ç¨‹              â”œâ”€â”€ Chromium è¿›ç¨‹
â”œâ”€â”€ data/browser_A/            â”œâ”€â”€ data/browser_B/
â”‚   â”œâ”€â”€ æŒ‡çº¹: fp_A.json        â”‚   â”œâ”€â”€ æŒ‡çº¹: fp_B.json
â”‚   â””â”€â”€ Cookie: cookie_A.json  â”‚   â””â”€â”€ Cookie: cookie_B.json
â””â”€â”€ å®Œå…¨éš”ç¦»                    â””â”€â”€ å®Œå…¨éš”ç¦»

ä¼˜åŠ¿: 100% æŒ‡çº¹éš”ç¦»ï¼Œæ— å…³è”é£é™©
åŠ£åŠ¿: æ¯ä¸ª Browser ~200MB å†…å­˜ï¼Œå»ºè®®æœ€å¤š 10 ä¸ªè´¦æˆ·/Worker
```

**å¹³å°ç³»ç»Ÿæ¶æ„**:

```
PlatformManager (å¹³å°ç®¡ç†å™¨)
â”œâ”€â”€ è‡ªåŠ¨åŠ è½½å¹³å°è„šæœ¬
â”œâ”€â”€ ç®¡ç†å¹³å°å®ä¾‹
â””â”€â”€ è·å–æ”¯æŒçš„å¹³å°åˆ—è¡¨

PlatformBase (å¹³å°åŸºç±»)
â”œâ”€â”€ é€šç”¨æ¥å£å®šä¹‰
â”œâ”€â”€ ç™»å½•ã€çˆ¬è™«ã€é€šçŸ¥æ–¹æ³•
â””â”€â”€ å…¬å…±å·¥å…·æ–¹æ³•

DouyinPlatform (å…·ä½“å®ç°)
â”œâ”€â”€ äºŒç»´ç ç™»å½•
â”œâ”€â”€ è¯„è®ºçˆ¬è™«
â””â”€â”€ ç§ä¿¡çˆ¬è™«

XiaohongshuPlatform (å¯æ‰©å±•)
â”œâ”€â”€ äºŒç»´ç ç™»å½•
â”œâ”€â”€ è¯„è®ºçˆ¬è™«
â””â”€â”€ ç§ä¿¡çˆ¬è™«
```

---

## ğŸ”„ é€šä¿¡æµç¨‹å›¾

### å®Œæ•´çš„è´¦æˆ·ç™»å½•æµç¨‹

```
Admin Web (3001)
    â”‚
    â”‚ 1. ç”¨æˆ·ç‚¹å‡»ã€ç™»å½•ã€‘
    â”‚
    â”œâ”€â”€â†’ Socket: master:login:start
    â”‚    {account_id, worker_id}
    â”‚
Master (3000)
    â”‚
    â”‚ 2. åˆ›å»º login_sessions è®°å½•
    â”‚ 3. æŸ¥è¯¢ Worker ä»£ç†é…ç½®
    â”‚
    â”œâ”€â”€â†’ Socket: master:login:start
    â”‚    {account_id, session_id, platform, proxy}
    â”‚
Worker (4000+)
    â”‚
    â”‚ 4. è·å–è´¦æˆ·ä¸“å± Browser
    â”‚ 5. åŠ è½½æŒ‡çº¹å’Œ Cookie
    â”‚ 6. å¯¼èˆªåˆ°ç™»å½•é¡µ
    â”‚ 7. ç­‰å¾…äºŒç»´ç åŠ è½½
    â”‚ 8. æå–äºŒç»´ç  (Base64)
    â”‚
    â”œâ”€â”€â†’ Socket: worker:login:qrcode
    â”‚    {session_id, qr_code_data}
    â”‚
Master (3000)
    â”‚
    â”‚ 9. æ›´æ–° login_sessions (status: scanning)
    â”‚
    â”œâ”€â”€â†’ Socket: login:qrcode:ready
    â”‚    {session_id, qr_code_data, expires_at}
    â”‚
Admin Web (3001)
    â”‚
    â”‚ 10. æ˜¾ç¤ºäºŒç»´ç å¼¹çª—
    â”‚ 11. å€’è®¡æ—¶ 5 åˆ†é’Ÿ
    â”‚ 12. ç”¨æˆ·ä½¿ç”¨æ‰‹æœºæ‰«ç ç™»å½•
    â”‚
Worker (4000+)
    â”‚
    â”‚ 13. è½®è¯¢ç™»å½•çŠ¶æ€
    â”‚ 14. æ£€æµ‹åˆ°ç™»å½•æˆåŠŸ
    â”‚ 15. æå– cookies + user_info
    â”‚ 16. ä¿å­˜åˆ°æœ¬åœ°æ–‡ä»¶
    â”‚
    â”œâ”€â”€â†’ Socket: worker:login:status
    â”‚    {session_id, status: success, cookies, user_info, fingerprint}
    â”‚
Master (3000)
    â”‚
    â”‚ 17. æ›´æ–° accounts è¡¨
    â”‚    - login_status: logged_in
    â”‚    - credentials: cookies
    â”‚    - user_info: ç”¨æˆ·ä¿¡æ¯
    â”‚    - cookies_valid_until: 7 å¤©å
    â”‚
    â”œâ”€â”€â†’ Socket: login:success
    â”‚    {session_id, account_id, user_info}
    â”‚
Admin Web (3001)
    â”‚
    â”‚ 18. å…³é—­äºŒç»´ç å¼¹çª—
    â”‚ 19. æ˜¾ç¤ºæˆåŠŸæç¤º
    â”‚ 20. åˆ·æ–°è´¦æˆ·åˆ—è¡¨
    â”‚
å®Œæˆ âœ…
```

---

## ğŸ“Š ç³»ç»Ÿé€šä¿¡æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin Web  â”‚ (React 3001)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Socket.IO /admin
       â”‚ HTTP REST API
       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚   Master    â”‚ (Node.js 3000)
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Socket.IO /worker
       â”‚ HTTP REST API
       â”‚
   â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚        â”‚        â”‚
â”Œâ”€â”€â–¼â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”
â”‚ W1  â”‚ â”‚ W2  â”‚ â”‚ W3  â”‚ (Node.js 4000+)
â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜

æ¯ä¸ª Worker ç®¡ç†å¤šä¸ª Browser:
  W1 â†’ Browser(Account A) + Browser(Account B)
  W2 â†’ Browser(Account C) + Browser(Account D)
  W3 â†’ Browser(Account E) + Browser(Account F)
```

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨æ¸…å•

### ç¬¬ä¸€æ­¥: å®‰è£…ä¾èµ–

```bash
# æ ¹ç›®å½•
npm install

# æˆ– pnpm
pnpm install
```

### ç¬¬äºŒæ­¥: å¯åŠ¨ Master

```bash
cd packages/master
npm start
# æˆ– pm2
pm2 start src/index.js --name "hiscrm-master"
```

### ç¬¬ä¸‰æ­¥: å¯åŠ¨ Worker

```bash
cd packages/worker
WORKER_ID=worker-1 PORT=4000 npm start

# å¤šä¸ª Worker
WORKER_ID=worker-2 PORT=4001 npm start &
WORKER_ID=worker-3 PORT=4002 npm start &
```

### ç¬¬å››æ­¥: å¯åŠ¨ Admin Web

```bash
cd packages/admin-web
npm start
# è®¿é—® http://localhost:3001
```

### éªŒè¯ç³»ç»Ÿæ­£å¸¸è¿è¡Œ

```bash
# 1. æ£€æŸ¥ Master æ˜¯å¦è¿è¡Œ
curl http://localhost:3000/health

# 2. æ£€æŸ¥ Admin Web æ˜¯å¦è¿è¡Œ
curl http://localhost:3001

# 3. æ£€æŸ¥æ•°æ®åº“æ˜¯å¦åˆå§‹åŒ–
ls -la packages/master/data/master.db

# 4. æŸ¥çœ‹ Master æ—¥å¿—
tail -f packages/master/logs/master.log

# 5. æŸ¥çœ‹ Worker æ—¥å¿—
tail -f packages/worker/logs/worker.log
```

---

## ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µé€ŸæŸ¥

| æ¦‚å¿µ | è¯´æ˜ | ç›¸å…³æ–‡æ¡£ |
|------|------|---------|
| **è´¦æˆ·éš”ç¦»** | æ¯ä¸ªè´¦æˆ·ç‹¬ç«‹ Browser è¿›ç¨‹ï¼Œå®Œå…¨éš”ç¦» | Worker ç¬¬ä¸€éƒ¨åˆ† |
| **æŒ‡çº¹éš”ç¦»** | éšæœºç”Ÿæˆå¹¶æŒä¹…åŒ–æµè§ˆå™¨æŒ‡çº¹ | Worker ç¬¬äºŒéƒ¨åˆ† |
| **äºŒç»´ç ç™»å½•** | é€šè¿‡ Worker è‡ªåŠ¨åŒ–æå–äºŒç»´ç  | Master |
| **ä»»åŠ¡è°ƒåº¦** | Master å®šæœŸåˆ†é…ç›‘æ§ä»»åŠ¡ç»™ Worker | Master |
| **å¿ƒè·³ç›‘æ§** | Worker æ¯ 10 ç§’å‘é€å¿ƒè·³ï¼ŒMaster æ£€æŸ¥ç¦»çº¿ | Master |
| **å¹³å°ç³»ç»Ÿ** | åŠ¨æ€åŠ è½½å¹³å°è„šæœ¬æ”¯æŒå¤šå¹³å° | Worker ç¬¬ä¸€éƒ¨åˆ† |
| **å¤š Worker** | æ”¯æŒå¤šä¸ª Worker èŠ‚ç‚¹å¹¶è¡Œè¿è¡Œ | Masterã€Worker |
| **ä»£ç†æ”¯æŒ** | æ”¯æŒ HTTP/HTTPS/Socks5 ä»£ç† | Worker ç¬¬äºŒéƒ¨åˆ† |

---

## ğŸ“ å¸¸è§é—®é¢˜é€ŸæŸ¥

| é—®é¢˜ | ä½ç½® | è§£å†³æ–¹æ¡ˆ |
|------|------|---------|
| å¦‚ä½•æ·»åŠ æ–°è´¦æˆ·ï¼Ÿ | Admin Web æ–‡æ¡£ | è´¦æˆ·ç®¡ç†é¡µé¢ |
| å¦‚ä½•å¯åŠ¨ç™»å½•ï¼Ÿ | Admin Web + Master æ–‡æ¡£ | ç‚¹å‡»ã€ç™»å½•ã€‘æŒ‰é’® |
| å¦‚ä½•æŸ¥çœ‹æ¶ˆæ¯ï¼Ÿ | Admin Web æ–‡æ¡£ | æ¶ˆæ¯ç®¡ç†é¡µé¢ |
| å¦‚ä½•æ·»åŠ  Workerï¼Ÿ | Worker + Master æ–‡æ¡£ | å¯åŠ¨æ–° Worker è¿›ç¨‹ |
| å¦‚ä½•é…ç½®ä»£ç†ï¼Ÿ | Admin Web + Worker æ–‡æ¡£ | ä»£ç†ç®¡ç†é¡µé¢ |
| å¦‚ä½•æŸ¥çœ‹æ—¥å¿—ï¼Ÿ | å„æ–‡æ¡£éƒ¨ç½²è¯´æ˜ | tail -f logs/ |
| å¦‚ä½•æ‰©å±•å¹³å°ï¼Ÿ | Worker ç¬¬ä¸€éƒ¨åˆ† | åˆ›å»ºæ–°çš„ Platform ç±» |
| å¦‚ä½•æ€§èƒ½ä¼˜åŒ–ï¼Ÿ | Worker ç¬¬äºŒéƒ¨åˆ† | å‡å°‘å†…å­˜å ç”¨ã€é™åˆ¶å¹¶å‘ |

---

## ğŸ“ æ–‡æ¡£ç»´æŠ¤è®¡åˆ’

| ä»»åŠ¡ | é¢‘ç‡ | è´Ÿè´£äºº |
|------|------|--------|
| æ›´æ–° API æ–‡æ¡£ | æ¯æ¬¡ API å˜æ›´å | åç«¯å¼€å‘ |
| æ›´æ–°æµç¨‹å›¾ | æ¯æ¬¡æ¶æ„å˜æ›´å | æ¶æ„è®¾è®¡ |
| æ›´æ–°éƒ¨ç½²è¯´æ˜ | æ¯æ¬¡å‡çº§å | è¿ç»´ |
| æ›´æ–°å¸¸è§é—®é¢˜ | æ¯å‘¨ | æŠ€æœ¯æ”¯æŒ |

---

## ğŸ“ å­¦ä¹ è·¯å¾„å»ºè®®

### åˆçº§ (1-2 å¤©)
- [ ] é˜…è¯»ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ
- [ ] ç†è§£ä¸‰ä¸ªæ¨¡å—çš„ä½œç”¨
- [ ] è·Ÿè¸ªä¸€ä¸ªå®Œæ•´çš„ç™»å½•æµç¨‹
- [ ] åœ¨æœ¬åœ°æˆåŠŸéƒ¨ç½²ç³»ç»Ÿ

### ä¸­çº§ (3-5 å¤©)
- [ ] ç ”ç©¶ Admin Web å‰ç«¯ä»£ç 
- [ ] ç ”ç©¶ Master æ•°æ®åº“è®¾è®¡
- [ ] ç ”ç©¶ Worker å¤š Browser æ¶æ„
- [ ] ä¿®å¤ä¸€ä¸ªç®€å•çš„ Bug

### é«˜çº§ (1-2 å‘¨)
- [ ] æ·±å…¥ç†è§£ Socket.IO é€šä¿¡æœºåˆ¶
- [ ] æ·±å…¥ç†è§£ Playwright æµè§ˆå™¨è‡ªåŠ¨åŒ–
- [ ] æ·»åŠ ä¸€ä¸ªæ–°çš„å¹³å°æ”¯æŒ
- [ ] ä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½

---

## ğŸ“š ç›¸å…³èµ„æº

### æŠ€æœ¯æ–‡æ¡£
- [React 18 å®˜æ–¹æ–‡æ¡£](https://react.dev)
- [Socket.IO å®˜æ–¹æ–‡æ¡£](https://socket.io/docs)
- [Playwright å®˜æ–¹æ–‡æ¡£](https://playwright.dev)
- [SQLite å®˜æ–¹æ–‡æ¡£](https://www.sqlite.org/docs.html)
- [Ant Design å®˜æ–¹æ–‡æ¡£](https://ant.design)

### é¡¹ç›®æ–‡æ¡£
- [CLAUDE.md](../CLAUDE.md) - å¼€å‘æŒ‡å—
- [ç³»ç»Ÿæ¶æ„ä¸æ ¸å¿ƒæµç¨‹.md](./ç³»ç»Ÿæ¶æ„ä¸æ ¸å¿ƒæµç¨‹.md) - æ¶æ„æ–‡æ¡£
- [Master ç«¯è®¾è®¡æ–¹æ¡ˆ.md](./Masterç«¯è®¾è®¡æ–¹æ¡ˆ.md) - Master è®¾è®¡

---

## ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|---------|
| 1.0.0 | 2025-10-18 | åˆç‰ˆå‘å¸ƒ |

---

**æœ€åæ›´æ–°**: 2025-10-18
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ
**çŠ¶æ€**: âœ… å®Œæ•´
